<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.znczXcx.dao.DingDanMapper">
	<update id="createTabByQyh">
		CREATE TABLE `ding_dan_${qyh}`  (
		  `id` int NOT NULL AUTO_INCREMENT,
		  `qyjlId` int NULL DEFAULT NULL,
		  `ddh` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,
		  `ddztId` int NULL DEFAULT NULL,
		  `yjzt` int NULL DEFAULT NULL,
		  `ejzt` int NULL DEFAULT NULL,
		  `sjsfzh` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,
		  `sjxm` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,
		  `cph` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,
		  `yjbfh` int NULL DEFAULT NULL,
		  `ejbfh` int NULL DEFAULT NULL,
		  `lxlx` int NULL DEFAULT NULL,
		  `yzxzl` float(10, 2) NULL DEFAULT NULL,
		  `sjzl` float(10, 2) NULL DEFAULT NULL,
		  `zlceb` float(10, 4) NULL DEFAULT NULL,
		  `wzlxId` int NULL DEFAULT NULL,
		  `wzId` int NULL DEFAULT NULL,
		  `yssId` int NULL DEFAULT NULL,
		  `fhdwId` int NULL DEFAULT NULL,
		  `shbmId` int NULL DEFAULT NULL,
		  `bjsj` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL,
		  `qytb` int NULL DEFAULT 1,
		  PRIMARY KEY (`id`) USING BTREE
		) ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Dynamic;
	</update>
	<insert id="add" parameterType="com.znczXcx.entity.DingDan">
		insert into `ding_dan_${qyh}`
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="qyjlId!=null">
				qyjlId,
			</if>
			<if test="ddh!=null">
				ddh,
			</if>
			<if test="yfwDdztId!=null">
				yfwDdztId,
			</if>
			<if test="qyDdztId!=null">
				qyDdztId,
			</if>
				yjzt,
				ejzt,
			<if test="sjsfzh!=null">
				sjsfzh,
			</if>
			<if test="sjxm!=null">
				sjxm,
			</if>
			<if test="cph!=null">
				cph,
			</if>
			<if test="lxlx!=null">
				lxlx,
			</if>
			<if test="yzxzl!=null">
				yzxzl,
			</if>
			<if test="sjzl!=null">
				sjzl,
			</if>
			<if test="zlceb!=null">
				zlceb,
			</if>
			<if test="yfwWzlxId!=null">
				yfwWzlxId,
			</if>
			<if test="qyWzlxId!=null">
				qyWzlxId,
			</if>
			<if test="yfwWzId!=null">
				yfwWzId,
			</if>
			<if test="qyWzId!=null">
				qyWzId,
			</if>
			<if test="yfwYssId!=null">
				yfwYssId,
			</if>
			<if test="qyYssId!=null">
				qyYssId,
			</if>
			<if test="yfwFhdwId!=null">
				yfwFhdwId,
			</if>
			<if test="qyFhdwId!=null">
				qyFhdwId,
			</if>
			<if test="yfwShbmId!=null">
				yfwShbmId,
			</if>
			<if test="qyShbmId!=null">
				qyShbmId,
			</if>
				bjsj,
			<if test="ewmlj!=null">
				ewmlj,
			</if>
			<if test="qytb!=null">
				qytb,
			</if>
		</trim>
		values
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="qyjlId!=null">
				#{qyjlId},
			</if>
			<if test="ddh!=null">
				#{ddh},
			</if>
			<if test="yfwDdztId!=null">
				#{yfwDdztId},
			</if>
			<if test="qyDdztId!=null">
				#{qyDdztId},
			</if>
				1,
				1,
			<if test="sjsfzh!=null">
				#{sjsfzh},
			</if>
			<if test="sjxm!=null">
				#{sjxm},
			</if>
			<if test="cph!=null">
				#{cph},
			</if>
			<if test="lxlx!=null">
				#{lxlx},
			</if>
			<if test="yzxzl!=null">
				#{yzxzl},
			</if>
			<if test="sjzl!=null">
				#{sjzl},
			</if>
			<if test="zlceb!=null">
				#{zlceb},
			</if>
			<if test="yfwWzlxId!=null">
				#{yfwWzlxId},
			</if>
			<if test="qyWzlxId!=null">
				#{qyWzlxId},
			</if>
			<if test="yfwWzId!=null">
				#{yfwWzId},
			</if>
			<if test="qyWzId!=null">
				#{qyWzId},
			</if>
			<if test="yfwYssId!=null">
				#{yfwYssId},
			</if>
			<if test="qyYssId!=null">
				#{qyYssId},
			</if>
			<if test="yfwFhdwId!=null">
				#{yfwFhdwId},
			</if>
			<if test="qyFhdwId!=null">
				#{qyFhdwId},
			</if>
			<if test="yfwShbmId!=null">
				#{yfwShbmId},
			</if>
			<if test="qyShbmId!=null">
				#{qyShbmId},
			</if>
				now(),
			<if test="ewmlj!=null">
				#{ewmlj},
			</if>
			<if test="qytb!=null">
				#{qytb},
			</if>
		</trim>
	</insert>
	<select id="selectByDdh" resultType="com.znczXcx.entity.DingDan">
		select dd.*,wzlx.mc wzlxMc,wz.mc wzMc,yss.mc yssMc,fhdw.mc fhdwMc,shbm.mc shbmMc from `ding_dan_${qyh}` dd left join `wu_zi_lei_xing_${qyh}` wzlx on dd.wzlxId=wzlx.id left join `wu_zi_${qyh}` wz on dd.wzId=wz.id
		 left join `yun_shu_shang_${qyh}` yss on dd.yssId=yss.id left join `fa_huo_dan_wei_${qyh}` fhdw on dd.fhdwId=fhdw.id
		 left join `shou_huo_bu_men_${qyh}` shbm on dd.shbmId=shbm.id where dd.ddh=#{ddh}
	</select>
</mapper>